## Cloudflare環境でAdSenseのプレビューが表示されない問題の解決策

Webサイトのパフォーマンス向上やセキュリティ対策として広く利用されているCloudflareですが、特定の機能がGoogle AdSenseの広告プレビューと干渉し、正常に表示できなくなるケースが報告されています。本記事では、その原因と具体的な解決手順について解説します。

-----

### 現象：AdSenseプレビューで「お探しのページが見つかりません」と表示される

Cloudflareを導入したサイトにGoogle AdSenseの広告コードを設置し、AdSenseの管理画面から広告の表示プレビューを確認しようとすると、以下のようなエラーメッセージが表示されることがあります。

![「お探しのページが見つかりません。URL をご確認のうえ、もう一度お試しください。」の画像](https://assets.kosuke0505.com/images/cf-adsense-preview-1.webp)

```
お探しのページが見つかりません。URL をご確認のうえ、もう一度お試しください。
```

サイト自体は正常に表示されているにもかかわらず、AdSenseのプレビュー機能だけが失敗する状態です。これにより、広告が意図した通りに表示されるかどうかの事前確認が困難になります。

-----

### 原因：Cloudflareの「ボットファイトモード」

この問題の主な原因は、Cloudflareの **ボットファイトモード (Bot Fight Mode)** にあります。

ボットファイトモードは、悪意のあるボットからのアクセスを自動的に検知し、ブロックするためのセキュリティ機能です。WebサイトへのDDoS攻撃やコンテンツのスクレイピング、スパム投稿などを試みるボットを識別し、JavaScriptチャレンジなどを実行して人間によるアクセスかどうかを判断します。

AdSenseのプレビュー機能は、Googleのサーバー（ボット）が対象ページにアクセスし、広告のレンダリングを試みることで実現されています。しかし、CloudflareのボットファイトモードがこのGoogleのボットを正当なアクセスとして認識できず、ブロックしてしまうために前述のエラーが発生します。

-----

### 解決手順：「ボットファイトモード」を無効化する

この問題を解決するには、Cloudflareのダッシュボードからボットファイトモードを無効化する必要があります。手順は以下の通りです。

1.  **Cloudflareにログイン**
    Cloudflareの[ダッシュボード](https://dash.cloudflare.com/)にログインします。

2.  **対象ドメインを選択**
    問題が発生しているサイトのドメインを選択します。

3.  **ボット設定画面へ移動**
    左側のサイドバーメニューから **[セキュリティ]** を選択し、その中にある **[ボット]** をクリックします。

4.  **ボットファイトモードを無効化**
    ボット設定画面に表示される **「ボットファイトモード」** のトグルスイッチをクリックして **オフ** にします。
    ![ボットファイトモードの画像](https://assets.kosuke0505.com/images/cf-adsense-preview-2.webp)

設定は自動的に保存されます。この操作の後、再度AdSenseの管理画面からプレビューを試みると、正常に表示されるようになります。

-----

## 補足：セキュリティに関する考慮事項

ボットファイトモードは、サイトを悪意のあるトラフィックから保護するための有効な機能です。これを無効化すると、その分のセキュリティレベルが低下する可能性がある点は認識しておく必要があります。

もし、より高度なボット対策が必要な場合は、有料プランで利用できる **「スーパーボットファイトモード」** へのアップグレードを検討するのも一つの方法です。こちらでは、より詳細なファイアウォールルールを設定し、Googleのクローラーのような既知の有益なボットからのアクセスを許可しつつ、悪意のあるボットのみをブロックするといった柔軟な制御が可能です。

-----

### まとめ

Cloudflareを利用しているサイトでAdSenseのプレビューが機能しない場合、多くは **ボットファイトモード** が原因です。ダッシュボードからこの機能を無効化することで、問題を迅速に解決できます。ただし、無効化に伴うセキュリティへの影響も考慮し、サイトの運用方針に合わせて適切な設定を選択してください。